#+OPTIONS: ':nil *:t -:t ::t <:t H:3 \n:nil ^:{} arch:headline
#+OPTIONS: author:t broken-links:nil c:nil creator:nil
#+OPTIONS: d:(not "LOGBOOK") date:t e:t email:nil f:t inline:t num:nil
#+OPTIONS: p:nil pri:nil prop:nil stat:t tags:t tasks:t tex:t
#+OPTIONS: timestamp:t title:t toc:nil todo:t |:t
#+TITLE: Dust wave case studies
#+AUTHOR: William Henney
#+EMAIL: will@henney.org
#+LANGUAGE: en
#+SELECT_TAGS: export
#+EXCLUDE_TAGS: noexport


Case studies of interesting objects for inclusion in bow paper II

* Selection criteria
+ High-ish ambient densities, since that is more likely to give an "interesting" case (e.g., radiation bow wave)
+ Prefer B stars to O stars, since then it is easy to get dust waves (gas--grain separation)
* Particular objects
** OB bowshocks in Orion Nebula
*** LP Ori
**** Info about star
+ Taken from [[file:~/Work/OrionNI/git-paper/models/individual/orion-stars.org]]
+ LP Ori (B1.5V) is 5 arcmin to the SSW of Trapezium
+ Parenago 1744 (B5V) is 12 arcmin to N of Trapezium
#+begin_src python
stars.update(
    LP = dict(T=23000., g=4.1, L=3.75), 
    P1774 = dict(T=16000., g=4.1, L=2.7), 
)
#+end_src

**** Info from Gaia
+ [[file:1528254812272O-result.json]]
+ Extracted and derived data
  | Quantity        | Unit       |               Value |
  |-----------------+------------+---------------------|
  | source_id       |            | 3017360348171372672 |
  | ra              | deg        |   83.79099195922022 |
  | ra_error        | mas        | 0.04624738839693305 |
  | dec             | deg        |  -5.464774673154743 |
  | dec_error       | mas        | 0.04518707614040293 |
  | parallax        | mas        |   2.447378178564449 |
  | parallax_error  | mas        | 0.06419465488526256 |
  | pmra            | mas.yr**-1 |  1.4821304012919858 |
  | pmra_error      | mas.yr**-1 | 0.11623231572816041 |
  | pmdec           | mas.yr**-1 |  1.6097056019763252 |
  | pmdec_error     | mas.yr**-1 | 0.09540261483321187 |
  | phot_g_mean_mag | mag        |            8.325929 |
  | bp_rp           | mag        |           0.3084631 |
  | a_g_val         | mag        |              0.4895 |
  |-----------------+------------+---------------------|
  | PA of pm        | deg        |        42.6 +/- 2.8 |
  | Total pm        | mas.yr**-1 |       2.19 +/- 0.11 |
  | V(tangential)   | km/s       |         4.2 +/- 0.2 |
  | D               | pc         |      408.6 +/- 10.7 |
  | RA              | hms        |   5@ 35' 9.8380702" |
  | Dec             | hms        |  -5@ 27' 53.188823" |
  #+TBLFM: @16$3=arctan(@9 +/- @10 / @11 +/- @12);f1::@17$3=sqrt((@9 +/- @10)**2 + (@11 +/- @12)**2);f2::@18$3=4.74 @-1 / (@7 +/- @8) ; f1::@19$3=1000/(@7 +/- @8) ; f1::@20$3=hms(@3/15)::@21$3=hms(@5)
+ [X] Check that this is the correct star!
  + 83.79099195922022, -5.464774673154743
    + 5@ 35' 9.8380702"
    + -5@ 27' 53.188823"
    + => 098-753 in OW notation
    + So this is consistent with the Spitzer position
+ So it is moving in roughly the right direction, but very slowly!
+ So, if it is a bow shock it must be an ambient flow - say 20 km/s
**** Info from ACS images
+ Lies just S of the bright bar
+ Size is roughly 3 arcsec, or 0.006 parsec
+ Symmetry axis PA is about +20 deg
+ Dark cloud immediately to E
  + southern extension of SW cloud
+ Images to use
  + I have saved cut-out images in all the Robberto ACS filters
  + e.g., [[file:data/LP-Ori-HST/lp-ori-f435w.fits]]
  + A good RGB image is made from
    + R: f850lp 0..5
    + G: f555w 0..9
    + B: f435w 0..9
**** Spitzer images of LP Ori
+ There are several things in the [[file:data/LP-Ori-Spitzer/]] folder
  + But I don't remember what is what
  + In some of the images, LP Ori is totally saturated
  + One that shows LP Ori well
    + [[file:data/LP-Ori-Spitzer/r18172160/ch2/pbcd/SPITZER_I2_18172160_0000_4_E8245118_maic.fits][SPITZER_I2_18172160_0000_4_E8245118_maic.fits]]
    + But the resolution is much worse than in the optical
    + Coordinates are about 098-753
      + 5:35:09.869 -5:27:52.55
      + 83.791004 -5.4646746
**** Other available data
+ [ ] Unfortunately, the new Bally observations (2016) do not cover LP Ori
  + The closest fields are the Beehive one (just to the east), and the Trapezium West one (just to the north), but it falls between the cracks
*** \theta^{1} Ori D
+ Size: about 1.5 arcsec"
  + => 0.003 pc
+ *Low dust opacity*: from both the Fulgencio paper and from Salgado:2016a, it seems that the FUV opacity in the ionized and neutral gas is lower than in the general ISM
  + 1.6e-22 cm^2 / H => 74 cm^2/g in PDR
  + 2e-22 cm^2 / H => 92 cm^2/g in HII region
+ But /careful/, these are absorption cross sections, /and/ they don't take into account scattering - so I think they are underestimates
+ So they say that the grain size is large, which is why there is low opacity per unit mass
  + Up to 1 micron, supposedly
  + This also explains the lowish dust temperatures of about 100 K - it would be higher for smaller grains
  + This is because the reduced grain opacity means that Lyman alpha dominates the heating over most of the nebula
    + Note that from Smith:2005a, T is > 150 K in th1D arc, and 170 K in LV1 arc
    + But, again, there might be problems.  They are taking the dust T as being equal to the color T, but it is more complicated than that, with a distribution of dust sizes
    + Also, they assume gray body with a power law dust opacity, but there is a silicate absorption feature at 11 microns - so not sure how that works
    + So this is sort of in agreement with the Cloudy models - they show T ~ 300 K for 0.1 micron grains at 0.1 pc around the 40 Msun star
+ For th1D, we have R = 0.003 pc
  + so this would correspond to about 200 K for the biggest ISM silicate grains, which is indeed higher than is observed
  + For LV1 we have about 6.5 arcsec, so (0.013 / cos i) pc, say 0.02
  + This gives T of about 200 for the 0.1 micron grains, which is a little bit higher than the 170 K observed, but not by much
  + [ ] /need to work out color temperature of Cloudy models/
  + Robberto:2005a finds that color T calculated around 11 microns is higher than that calculated at longer wavelengths
    + this is not really surprising
    + mid-IR Qabs ~ a, so that \kappa ~ a^3, so goes with mass
    + but T ~ 122 D_{17}^{-1/3} a^{-1/6} with a in micron
      + Peak b-body wavelength = 20 micron @ 100 K, or 10 micron @ 200 K
      + So this means we will see the small grains at 10 microns and the large grains at 20 microns
    + This means that 0.02 micron grains will be twice as hot




** Ones in Ochsendorf papers


* Fitting the arc shapes

** Comments on \theta^{1} D and LP Ori fits

*** \theta^{1} D fits
+ E.g., [[file:arc-fits/th1D-75.pdf]]
+ The symmetry axis of the circle fits is always about PA175
  + This is different from the brightness axis, which is more like PA200
+ Also, it looks like we could maybe add some more arc points on the left hand side
  + This would mean we would get a proper R90 for that side

*** LP Ori fits
+ E.g., [[file:arc-fits/lp-ori-110.pdf]]
+ This is even worse
  + Symmetry axis of fits is around PA050
  + But global axis is more like PA010
+ The fundamental problem here is that the star position is too far from the symmetry axis of the bow, and this is what leads to the circle fit algorithm breaking down
*** TODO It might be better to fit a parabola to all the points
+ 4 parameters
  + (x, y) of apex
    + It might work better if this were specified by hand, perhaps guided by the maximum in brightness
  + position angle of tail
  + coefficient a in y = a x^2
+ Then can calculate the deviation of the central star from the parabola axis
+ And can do circle fit to the points around the axis, which hopefully will be more consistent than the unconstrained version
  + We could make a pseudo-center by projecting the star position onto the parabola axis

** Arc fit for LP Ori
#+BEGIN_SRC python :eval no :tangle arc-fits/lp-ori-circle-fit.py
  import sys 
  sys.path.append("/Users/will/Dropbox/circle-fit")
  import circle_fit

  fits_file = "../data/LP-Ori-HST/lp-ori-f435w.fits"

  for delta_theta in 110, 130, 150:
      plotfile = f"lp-ori-{delta_theta:03d}.pdf"
      print('#### '*10)
      print("Creating", plotfile)
      circle_fit.plot_solution(
          f"lp-ori-acs-forma.reg",
          fits_file,
          plotfile,
          delta_theta=delta_theta,
          vmin=0.0, vmax=8.0,
      )
#+END_SRC

#+BEGIN_SRC sh :results verbatim
cd arc-fits
python lp-ori-circle-fit.py
#+END_SRC

#+RESULTS:
#+begin_example
#### #### #### #### #### #### #### #### #### #### 
Creating lp-ori-110.pdf
CircleFit(Pi = 1.595, Lambda = 1.369, dLambda = 0.109)
CircleFit(Pi = 1.320, Lambda = 1.576, dLambda = -0.282)
CircleFit(Pi = 1.535, Lambda = 1.415, dLambda = -0.321)
CircleFit(Pi = 1.480, Lambda = 1.380, dLambda = -0.335)
#### #### #### #### #### #### #### #### #### #### 
Creating lp-ori-130.pdf
CircleFit(Pi = 1.595, Lambda = 1.369, dLambda = 0.109)
CircleFit(Pi = 1.315, Lambda = 1.546, dLambda = -0.180)
CircleFit(Pi = 1.386, Lambda = 1.411, dLambda = -0.286)
CircleFit(Pi = 1.360, Lambda = 1.458, dLambda = -0.242)
#### #### #### #### #### #### #### #### #### #### 
Creating lp-ori-150.pdf
CircleFit(Pi = 1.595, Lambda = 1.369, dLambda = 0.109)
CircleFit(Pi = 1.245, Lambda = 1.532, dLambda = -0.315)
CircleFit(Pi = 1.334, Lambda = 1.549, dLambda = -0.160)
CircleFit(Pi = 1.315, Lambda = 1.546, dLambda = -0.180)
#+end_example


** Arc fit for th1D
#+BEGIN_SRC python :eval no :tangle arc-fits/th1d-circle-fit.py
  import sys 
  sys.path.append("/Users/will/Dropbox/circle-fit")
  import circle_fit

  fits_file = "/Users/will/Dropbox/JorgeBowshocks/MIR/SmithBally/wcs.mos11jy.fits"

  for delta_theta in 65, 70, 75, 80:
      plotfile = f"th1D-{delta_theta:02d}.pdf"
      print('#### '*10)
      print("Creating", plotfile)
      circle_fit.plot_solution(
          f"th1d-ori-smith-2005-forma.reg",
          fits_file,
          plotfile,
          delta_theta=delta_theta,
          vmin=0.0, vmax=0.01,
      )
#+END_SRC

#+BEGIN_SRC sh :results verbatim
cd arc-fits
python th1d-circle-fit.py
#+END_SRC

#+RESULTS:
#+begin_example
#### #### #### #### #### #### #### #### #### #### 
Creating th1D-65.pdf
CircleFit(Planitude = 1.863668610945027, Alatude = [ 1.5174858   1.47936061])
CircleFit(Planitude = 1.4369575034558033, Alatude = [ 1.34236887  1.37510133])
CircleFit(Planitude = 1.4369575034558033, Alatude = [ 1.34236887  1.37510133])
CircleFit(Planitude = 1.4369575034558033, Alatude = [ 1.34236887  1.37510133])
#### #### #### #### #### #### #### #### #### #### 
Creating th1D-70.pdf
CircleFit(Planitude = 1.863668610945027, Alatude = [ 1.5174858   1.47936061])
CircleFit(Planitude = 1.4078624613676836, Alatude = [ 1.33984663  1.3714574 ])
CircleFit(Planitude = 1.5558494149676698, Alatude = [ 1.37294133  1.38619122])
CircleFit(Planitude = 1.5558494149676698, Alatude = [ 1.37294133  1.38619122])
#### #### #### #### #### #### #### #### #### #### 
Creating th1D-75.pdf
CircleFit(Planitude = 1.863668610945027, Alatude = [ 1.5174858   1.47936061])
CircleFit(Planitude = 1.5029029947873929, Alatude = [ 1.37811972  1.38004071])
CircleFit(Planitude = 1.5029029947873929, Alatude = [ 1.37811972  1.38004071])
CircleFit(Planitude = 1.5029029947873929, Alatude = [ 1.37811972  1.38004071])
#### #### #### #### #### #### #### #### #### #### 
Creating th1D-80.pdf
CircleFit(Planitude = 1.863668610945027, Alatude = [ 1.5174858   1.47936061])
CircleFit(Planitude = 1.5029029947873929, Alatude = [ 1.37811972  1.38004071])
CircleFit(Planitude = 1.5029029947873929, Alatude = [ 1.37811972  1.38004071])
CircleFit(Planitude = 1.5029029947873929, Alatude = [ 1.37811972  1.38004071])
#+end_example

Do the bootstrap resampling
#+BEGIN_SRC sh :eval no
cd arc-fits
python ~/Dropbox/circle-fit/plot-bootstrap.py th1d-ori-smith-2005-forma.reg ~/Dropbox/JorgeBowshocks/MIR/SmithBally/wcs.mos11jy.fits 75 0.5 bootstrap-th1d-75-05.pdf
#+END_SRC
